buildInfo:
  github_repo_name: {{github_repo_name}}
  ecr_repo_name: {{ecr_repo_name}}
app:
  image: {{app_image}}
  tag: {{app_image_tag}}
  port: 9090
  monitoringPort: {{monitoring_port}}
  livenessProbe: /actuator/health/liveness
  readinessProbe: /actuator/health/readiness
replicaCount: 1
resources:
  requests:
    cpu: 10m
    memory: 300Mi
env:
  plaintext:
    POSTGRES_CONNECT_URL: 'jdbc:postgresql://{{rds_host}}:{{rds_port}}/{{machine_integration_db}}?ApplicationName=machine-integration'
    POSTGRES_CONNECTION_POOL: {{postgres_connection_pool}}
    POSTGRES_AUTO_DDL: {{postgres_auto_ddl}}
    KAFKA_BROKER_SERVICE_URL: '{% for kafka_ip in kafka_ips %}{{kafka_ip}}:{{kafka_port}}{% if not loop.last %},{% endif %}{% endfor %}'
    S3_BUCKET_NAME: 'tml-ep-prod-machine-data'
    S3_BUCKET_REGION: 'ap-south-1'
    MQTT_BROKER_TYPE: 'none'
    MQTT_ENDPOINT: 'NA'
    MQTT_CLIENT_ID: 'NA'
    MQTT_TOPIC_BASE: 'serial-data'
    MQTT_CERTIFICATE_FILE: 'NA'
    MQTT_PRIVATE_KEY_FILE: 'NA'
    MQTT_PERSISTENT_CONNECTION: 'false'
    KAFKA_MACHINE_RAW_NON_SERIAL_DATA_TOPIC: 'machine-raw-non-serial-data-v1'
    KAFKA_MACHINE_RAW_SERIAL_DATA_TOPIC: 'machine-raw-serial-data-v1'
    JAVA_TOOL_OPTIONS: '{{default_java_flags}}'
  secret:
    POSTGRES_USERNAME: {{machine_integration_db_username}}
    POSTGRES_PASSWORD: {{machine_integration_db_password}}
mounts:
  secret:
    - name: mqtt-client-certificate
      target: /mqtt-certs/certificate.pem.crt
      encodedContent: {{mqtt_client_certificate}}
    - name: mqtt-client-private-key
      target: /mqtt-certs/private-key.pem.key
      encodedContent: {{mqtt_client_private_key}}
podmonitor:
  endpoints:
    - path: /actuator/prometheus
service:
  port: 80