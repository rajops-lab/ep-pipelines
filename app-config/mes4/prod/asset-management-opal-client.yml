buildInfo:
  github_repo_name: {{github_repo_name}}
  ecr_repo_name: {{ecr_repo_name}}
app:
  image: {{app_image}}
  tag: {{app_image_tag}}
  port: 7000
  monitoringPort: 7000
  livenessProbe: /healthcheck
  readinessProbe: /healthcheck
replicaCount: {{opal_client_replica_count}}
resources:
  requests:
    cpu: {{opal_client_cpu_request}}
    memory: {{opal_client_memory_request}}
  limits:
    cpu: {{opal_client_cpu_limit}}
    memory: {{opal_client_memory_limit}}
env:
  plaintext:
    OPAL_SERVER_URL: {{OPAL_SERVER_URL}}
    OPAL_FETCH_PROVIDER_MODULES: {{OPAL_FETCH_PROVIDER_MODULES}}
    OPAL_LOG_FORMAT_INCLUDE_PID: {{OPAL_LOG_FORMAT_INCLUDE_PID}}
    OPAL_INLINE_OPA_LOG_FORMAT: {{OPAL_INLINE_OPA_LOG_FORMAT}}
    OPAL_POLICY_STORE_URL: {{OPAL_POLICY_STORE_URL}}
    INLINE_OPA_ENABLED: {{INLINE_OPA_ENABLED}}
    ses_sourceemail: {{ses_sourceemail}}
service:
  port: 80
kong:
  image: {{kong_configure_image}}
  tag: {{kong_configure_image_tag}}
  services:
    - name: asset-management-opal-client
      authn: oidc-auth
      user_info_endpoint: {{central_keycloak_user_info_endpoint}}
      service_path: /
      connect_timeout: 120
      write_timeout: 120
      read_timeout: 120
      cors_allowed_origins:
        - https://asset-management.{{fractal_base_domain}}
        - https://api.asset-management.esakha.tatamotors.com
        - {{local_development_domain}}
      routes:
        paths:
          - /opal-client
        strip_path: "true"
